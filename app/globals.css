/* Leaflet Maps CSS - must be before @tailwind for Turbopack */
@import 'leaflet/dist/leaflet.css';

@tailwind base;
@tailwind components;
@tailwind utilities;

/* CSS Animations for landing page - replaces framer-motion SSR issues */
@layer utilities {
  @keyframes fade-in-up {
    from {
      opacity: 0;
      transform: translateY(20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .animate-fade-in-up {
    animation: fade-in-up 0.8s ease-out forwards;
  }

  .animate-fade-in-up-delay-1 {
    animation: fade-in-up 0.6s ease-out 0.1s forwards;
    opacity: 0;
  }

  .animate-fade-in-up-delay-2 {
    animation: fade-in-up 0.6s ease-out 0.2s forwards;
    opacity: 0;
  }

  .animate-fade-in-up-delay-3 {
    animation: fade-in-up 0.6s ease-out 0.3s forwards;
    opacity: 0;
  }
}

/* ADAPTIVE UI SYSTEM */
@layer base {
  :root {
    --adaptive-text-scale: 1;
    --adaptive-target-min: 44px;
    --adaptive-spacing-scale: 1;
    --adaptive-animation-duration: 200ms;
    --color-primary: 244 63 94; /* rose-500 / Coral Heart */
    --color-trust: 15 118 110; /* teal-700 / Trust Teal */
    --color-success: 34 197 94;
    --color-danger: 239 68 68;
    --color-superlike: 59 130 246;
    --shadow-card: 0 4px 20px rgba(0, 0, 0, 0.08);
    --radius-lg: 0.75rem;
    --radius-2xl: 1.25rem;

    /* Safe Area Insets for notched devices */
    --safe-top: env(safe-area-inset-top, 0px);
    --safe-right: env(safe-area-inset-right, 0px);
    --safe-bottom: env(safe-area-inset-bottom, 0px);
    --safe-left: env(safe-area-inset-left, 0px);
  }

  @media (prefers-reduced-motion: reduce) {
    :root { --adaptive-animation-duration: 0ms; }
    *, *::before, *::after {
      animation-duration: 0.01ms !important;
      transition-duration: 0.01ms !important;
    }
  }

  html {
    font-size: calc(16px * var(--adaptive-text-scale));
    scroll-behavior: smooth;
    -webkit-font-smoothing: antialiased;
  }

  body {
    min-height: 100vh;
    min-height: 100dvh; /* Dynamic viewport height for mobile */
    overscroll-behavior: none; /* Prevent pull-to-refresh on Android */
    background-color: #fafaf9; /* stone-50 as default background */
  }

  /* Prevent text selection on touch */
  .touch-manipulation {
    touch-action: manipulation;
    -webkit-user-select: none;
    user-select: none;
  }
}

/* SAFE AREA UTILITIES */
@layer utilities {
  .safe-area-inset {
    padding-top: var(--safe-top);
    padding-right: var(--safe-right);
    padding-bottom: var(--safe-bottom);
    padding-left: var(--safe-left);
  }

  .safe-top {
    padding-top: var(--safe-top);
  }

  .safe-bottom {
    padding-bottom: var(--safe-bottom);
  }

  .pt-safe {
    padding-top: max(1rem, var(--safe-top));
  }

  .pb-safe {
    padding-bottom: max(1rem, var(--safe-bottom));
  }

  /* Touch-optimized button styles */
  .touch-target {
    min-height: 48px;
    min-width: 48px;
  }

  /* Prevent double-tap zoom */
  .touch-action-manipulation {
    touch-action: manipulation;
  }

  /* Hide scrollbar but keep scrollable */
  .scrollbar-hide {
    -ms-overflow-style: none;
    scrollbar-width: none;
  }

  .scrollbar-hide::-webkit-scrollbar {
    display: none;
  }

  /* Momentum scrolling for iOS */
  .scroll-smooth-touch {
    -webkit-overflow-scrolling: touch;
  }
}

@layer components {
  .btn {
    @apply inline-flex items-center justify-center font-semibold transition-all;
    min-height: var(--adaptive-target-min);
    padding: calc(0.75rem * var(--adaptive-spacing-scale)) calc(1.5rem * var(--adaptive-spacing-scale));
    border-radius: var(--radius-lg);
  }
  .btn:focus-visible { @apply outline-none ring-2 ring-rose-500 ring-offset-2; }
  .btn:disabled { @apply opacity-50 cursor-not-allowed; }
  .btn-primary {
    @apply btn text-white shadow-lg;
    background: linear-gradient(135deg, rgb(var(--color-primary)) 0%, #D81B60 100%);
  }
  .btn-primary:hover:not(:disabled) { @apply shadow-xl; transform: translateY(-1px); }
  .btn-secondary { @apply btn bg-gray-100 text-gray-800 hover:bg-gray-200; }
  .btn-lg { min-height: calc(var(--adaptive-target-min) * 1.25); @apply text-lg; }

  .btn-action {
    @apply rounded-full flex items-center justify-center shadow-lg transition-all;
    width: calc(64px * var(--adaptive-spacing-scale));
    height: calc(64px * var(--adaptive-spacing-scale));
  }
  .btn-action:hover:not(:disabled) { transform: scale(1.1); }
  .btn-like {
    @apply btn-action text-white;
    background: linear-gradient(135deg, rgb(var(--color-success)) 0%, #16A34A 100%);
  }
  .btn-pass { @apply btn-action bg-white border-2 border-red-400 text-red-500; }
  .btn-superlike {
    @apply btn-action text-white;
    background: linear-gradient(135deg, rgb(var(--color-superlike)) 0%, #2563EB 100%);
  }

  .card {
    @apply bg-white overflow-hidden;
    border-radius: var(--radius-2xl);
    box-shadow: var(--shadow-card);
  }
  .card-dating { @apply card; aspect-ratio: 3 / 4; }

  .input {
    @apply w-full border border-gray-300 bg-white text-gray-900 placeholder:text-gray-400;
    min-height: var(--adaptive-target-min);
    padding: calc(0.75rem * var(--adaptive-spacing-scale)) calc(1rem * var(--adaptive-spacing-scale));
    border-radius: var(--radius-lg);
  }
  .input:focus { @apply outline-none ring-2 ring-rose-500 border-rose-500; }

  .badge { @apply inline-flex items-center gap-1 font-semibold px-3 py-1 rounded-full text-sm; }
  .badge-verified { @apply badge bg-blue-500 text-white; }
  .badge-interest { @apply badge bg-rose-100 text-rose-800; }

  .help-box { @apply p-4 rounded-xl border-2 bg-blue-50 border-blue-200; }
  .skeleton { @apply bg-gray-200 rounded animate-pulse; }
}

@layer utilities {
  .p-adaptive { padding: calc(1rem * var(--adaptive-spacing-scale)); }
  .gap-adaptive { gap: calc(1rem * var(--adaptive-spacing-scale)); }
  .text-adaptive { font-size: calc(1rem * var(--adaptive-text-scale)); }
  .touch-target { min-width: var(--adaptive-target-min); min-height: var(--adaptive-target-min); }
  .focus-ring { @apply focus:outline-none focus-visible:ring-2 focus-visible:ring-rose-500 focus-visible:ring-offset-2; }
  .glass { @apply bg-white/80 backdrop-blur-md; }
  .glass-dark { @apply bg-black/50 backdrop-blur-md; }
  .text-gradient { @apply bg-clip-text text-transparent; background-image: linear-gradient(135deg, #E91E63 0%, #F472B6 100%); }
  .safe-bottom { padding-bottom: env(safe-area-inset-bottom); }
}

/* =========================================
   ACCESSIBILITY FEATURES - WERELDKLASSE
   ========================================= */

/* High Contrast Mode - WCAG AAA (7:1 ratio) */
.high-contrast {
  --color-bg: 255 255 255;
  --color-text: 0 0 0;
  --color-primary: 220 38 38; /* Darker rose for better contrast */
}

.high-contrast * {
  border-color: #000 !important;
  outline-color: #000 !important;
}

.high-contrast button,
.high-contrast a {
  font-weight: 600 !important;
  text-decoration: underline !important;
}

/* Large Text Mode - 125% scaling */
.large-text {
  --adaptive-text-scale: 1.25;
  line-height: 1.6 !important;
  letter-spacing: 0.015em !important;
}

.large-text h1 { font-size: 3rem !important; }
.large-text h2 { font-size: 2.25rem !important; }
.large-text h3 { font-size: 1.875rem !important; }
.large-text p, .large-text li, .large-text span { font-size: 1.25rem !important; }

/* Large Targets Mode - Minimum 56px touch targets */
.large-targets {
  --adaptive-target-min: 56px;
}

.large-targets button,
.large-targets a,
.large-targets input,
.large-targets select {
  min-height: 56px !important;
  min-width: 56px !important;
  padding: 1rem 1.5rem !important;
  font-size: 1.125rem !important;
}

.large-targets .icon {
  width: 28px !important;
  height: 28px !important;
}

/* Vision Impaired Mode - Master toggle combining all visual aids */
.vision-impaired {
  --color-bg: 255 255 255;
  --color-text: 0 0 0;
}

.vision-impaired * {
  font-weight: 500 !important;
}

.vision-impaired img {
  border: 3px solid #000 !important;
}

/* Color Blind Modes - Deuteranopia (green deficiency) */
.colorblind-deuteranopia {
  filter: url('#deuteranopia-filter');
}

/* Color Blind Modes - Protanopia (red deficiency) */
.colorblind-protanopia {
  filter: url('#protanopia-filter');
}

/* Color Blind Modes - Tritanopia (blue deficiency) */
.colorblind-tritanopia {
  filter: url('#tritanopia-filter');
}

/* Focus Indicators - Extra prominent for keyboard navigation */
.vision-impaired *:focus,
.large-targets *:focus {
  outline: 4px solid #2563eb !important;
  outline-offset: 4px !important;
  box-shadow: 0 0 0 6px rgba(37, 99, 235, 0.2) !important;
}

/* Screen Reader Only (visually hidden but accessible) */
.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border-width: 0;
}

/* Skip to Content Link - For keyboard users */
.skip-to-content {
  position: absolute;
  top: -40px;
  left: 0;
  background: #000;
  color: #fff;
  padding: 8px 16px;
  text-decoration: none;
  z-index: 100;
  font-weight: 600;
}

.skip-to-content:focus {
  top: 0;
}

/* Reduced Motion - Respect user preferences */
@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }
}